check=1

local common = dofile(path_scripts.."S-M-auto-script\\lib\\common.lua")

common.simpleStart({
    mapName = "克杜卡的咆哮",
    mapCount = 1,
    planeId = 94801,
    -- 地图名称列表，需和mapIds一一对应
    mapIds = {83100,9300,9301,9302,9303,9304,9305,9306,9307,9308},
    overtime = 30, --超时时间，/分钟
    endMapIds = {9306,9307,9308}, -- 结束一轮的地图id 默认为最后一张图，设置则以此值为准，没有可以不设置
    initSettings = {  -- 脚本初始化时的配置参数 可以不设置
        tobot_giveitemif=1,
		tobot_fastladder = 0, -- 取消快速爬梯，防止大桥下楼梯不稳定
	},
	
	isLuckyDog = true,

    -- 脚本名称列表，需和mapIds一一对应
    -- 支持16进制hex编码脚本
    -- 由于正则不通用，因此判断是否用hex的地方是字符串长度大于30
    scripts = {
       -- 副本进门
       "BDF8C8EBB4ABCBCDC3C52CD7F326D3D2CAB12C313930302C313335392CD7F3C5DC2CD6B4D0D0BAF3B5C8B4FDA3A8BAC1C3EBA3A92C343030300D0ABDF8C8EBB4ABCBCDC3C52CD7F326D3D2CAB12C313932302C313335392CD7F3C5DC2CD6B4D0D0BAF3B5C8B4FDA3A8BAC1C3EBA3A92C343030300D0ABDF8C8EBB4ABCBCDC3C52CD7F326D3D2CAB12C313838302C313335392CD7F3C5DC2CD6B4D0D0BAF3B5C8B4FDA3A8BAC1C3EBA3A92C343030300D0AD6C7C4DCD7AAC9ED2CD7F3C5DCCAB12C313730302C313335392CD3D2C5DC2C0D0AD6C7C4DCD7AAC9ED2CD3D2C5DCCAB12C323130302C313335392CD7F3C5DC2C",
       -- 副本1
       "D7F3CCF828D6FAC5DC292CD7F3C5DCCAB12C323335302C3733362CD3D2C5DC2C0D0AD7F3CCF828D6FAC5DC292CD7F3C5DCCAB12C323035302C3836342CD7F3C5DC2C0D0AD3D2CCF82BC9CFC5C0CCDDD7D32CD7F326D3D2CAB12C3839352C313531392CD3D2C5DC2C0D0ACFC2C5C0CCDDD7D32CD7F326D3D2CAB12C313236342C313032302CD3D2C5DC2C0D0ACFC2C5C0CCDDD7D32CD7F326D3D2CAB12C313236342C313036302CD3D2C5DC2C0D0ACBC9BFAACCDDD7D32CD7F326D3D2CAB12C313236342C313032302CD3D2C5DC2C0D0ACBC9BFAACCDDD7D32CD7F326D3D2CAB12C313236342C313036302CD3D2C5DC2C0D0AD7F3CCF82BC9CFC5C0CCDDD7D32CD7F326D3D2CAB12C323931322C313531392CD3D2C5DC2C0D0AD3D2CCF82BC9CFC5C0CCDDD7D32CD7F3C5DCCAB12C313530302C313339312CD3D2C5DC2C0D0AD3D2CCF82BC9CFC5C0CCDDD7D32CD7F3C5DCCAB12C313430302C313339312CD3D2C5DC2C0D0AD7F3CCF82CD7F326D3D2CAB12C313931392C3939312CD7F3C5DC2C0D0ABDF8C8EBB4ABCBCDC3C52CD7F326D3D2CAB12C333036302C313531392CB2BBB1E42C0D0ABDF8C8EBB4ABCBCDC3C52CD7F326D3D2CAB12C333038302C313531392CB2BBB1E42C0D0ABDF8C8EBB4ABCBCDC3C52CD7F326D3D2CAB12C333130302C313531392CB2BBB1E42C",
       -- 副本2
       "CFC2C5C0CCDDD7D32CD7F3C5DCCAB12C323936302C3434372CD7F3C5DC2C0D0ACBC9BFAACCDDD7D32CCFC2CCDDD7D32C323936302C3435302CD7F3C5DC2C0D0AD3D2CCF82BC9CFC5C0CCDDD7D32CD7F3C5DCCAB12C3130302C313531392CD7F3C5DC2C0D0AD3D2CCF828D6FAC5DC292CD3D2C5DCCAB12C3335302C313133352CB2BBB1E42C0D0AD7F3CCF82BC9CFC5C0CCDDD7D32CD3D2C5DCCAB12C313530302C313531392CD3D2C5DC2C0D0ABDF8C8EBB4ABCBCDC3C52CD7F326D3D2CAB12C333036302C313531392CB2BBB1E42C0D0ABDF8C8EBB4ABCBCDC3C52CD7F326D3D2CAB12C333038302C313531392CB2BBB1E42C0D0ABDF8C8EBB4ABCBCDC3C52CD7F326D3D2CAB12C333130302C313531392CB2BBB1E42C",
       -- 副本3
       "D3D2CCF82CD3D2C5DCCAB12C313730302C3436332CD7F3C5DC2C0D0AD6C7C4DCD7AAC9ED2CD3D2C5DCCAB12C313930302C3436332CD7F3C5DC2C0D0ABDF8C8EBB4ABCBCDC3C52CD7F326D3D2CAB12C333032302C313531392CB2BBB1E42C0D0ABDF8C8EBB4ABCBCDC3C52CD7F326D3D2CAB12C333030302C313531392CB2BBB1E42C0D0ABDF8C8EBB4ABCBCDC3C52CD7F326D3D2CAB12C333034302C313531392CB2BBB1E42C",
       -- 副本4
       "D3D2CCF82CD7F326D3D2CAB12C323134332C313531392CD7F3C5DC2C0D0AD3D2CCF82CD7F3C5DCCAB12C323430302C313332372CD7F3C5DC2C0D0AC9CFCCF82CD7F3C5DCCAB12C323330302C3935392CD7F3C5DC2C0D0AD3D2CCF82CD7F3C5DCCAB12C323430302C313332372CD7F3C5DC2C0D0AD7F3CCF82CD7F3C5DCCAB12C313730302C3831352CD7F3C5DC2C0D0AD3D2CCF82CD3D2C5DCCAB12C313730302C3436332CD7F3C5DC2C0D0AD3D2CCF82CD7F326D3D2CAB12C3833312C3934332CD3D2C5DC2C0D0ABDF8C8EBB4ABCBCDC3C52CD7F326D3D2CAB12C323937302C313531392CB2BBB1E42C0D0ABDF8C8EBB4ABCBCDC3C52CD7F326D3D2CAB12C323939302C313531392CB2BBB1E42C0D0ABDF8C8EBB4ABCBCDC3C52CD7F326D3D2CAB12C323935302C313531392CB2BBB1E42C",
       -- 副本5
       "D3D2CCF82BC9CFC5C0CCDDD7D32CD7F326D3D2CAB12C3338342C323939312CD7F3C5DC2C0D0ACFC2C5C0CCDDD7D32CD7F3C5DCCAB12C3732302C323039352CD3D2C5DC2C0D0AD3D2CCF82CD7F326D3D2CAB12C3932372C323939312CD3D2C5DC2C0D0AC9CFCCF82CD7F326D3D2CAB12C333136372C323939312CD7F3C5DC2C0D0ABDF8C8EBB4ABCBCDC3C52CD7F326D3D2CAB12C333034302C323633392CB2BBB1E42CD6B4D0D0BAF3B5C8B4FDA3A8BAC1C3EBA3A92C323030300D0ABDF8C8EBB4ABCBCDC3C52CD7F326D3D2CAB12C333036302C323633392CB2BBB1E42CD6B4D0D0BAF3B5C8B4FDA3A8BAC1C3EBA3A92C323030300D0ABDF8C8EBB4ABCBCDC3C52CD7F326D3D2CAB12C333038302C323633392CB2BBB1E42CD6B4D0D0BAF3B5C8B4FDA3A8BAC1C3EBA3A92C32303030",
       -- 副本6
       "D7F3CCF82BC9CFC5C0CCDDD7D32CD3D2C5DCCAB12C313030302C323836332CD7F3C5DC2C0D0AC9CFCCF82BC9CFC5C0CCDDD7D32CD7F326D3D2CAB12C3638382C323431352CD7F3C5DC2C0D0AC9CFCCF82BC9CFC5C0CCDDD7D32CD7F326D3D2CAB12C3237322C323036332CD3D2C5DC2C0D0AD6C7C4DCD7AAC9ED2CD7F3C5DCCAB12C313635302C323537352CD3D2C5DC2C0D0AD6C7C4DCD7AAC9ED2CD7F326D3D2CAB12C3832302C323431352CD7F3C5DC2C0D0AD6C7C4DCD7AAC9ED2CD7F326D3D2CAB12C323330302C323036332CD7F3C5DC2C0D0AD7F3CCF82CD7F326D3D2CAB12C313430382C323836332CD7F3C5DC2C0D0AC9CFCCF82CD7F326D3D2CAB12C313832332C323836332CD3D2C5DC2C0D0AC9CFCCF82CD7F326D3D2CAB12C323134342C323836332CD7F3C5DC2C0D0AD3D2CCF82CD7F326D3D2CAB12C323339392C323836332CD7F3C5DC2C0D0ABDF8C8EBB4ABCBCDC3C52CD7F326D3D2CAB12C333034352C323836332CD7F3C5DC2CD6B4D0D0BAF3B5C8B4FDA3A8BAC1C3EBA3A92C3230300D0ABDF8C8EBB4ABCBCDC3C52CD7F326D3D2CAB12C333036352C323836332CD7F3C5DC2CD6B4D0D0BAF3B5C8B4FDA3A8BAC1C3EBA3A92C3230300D0ABDF8C8EBB4ABCBCDC3C52CD7F326D3D2CAB12C333038352C323836332CD7F3C5DC2CD6B4D0D0BAF3B5C8B4FDA3A8BAC1C3EBA3A92C3230300D0AD7F3CCF82CD7F326D3D2CAB12C323638382C323139312CD7F3C5DC2C0D0ACBC9BFAACCDDD7D32CD7F326D3D2CAB12C313737302C323036342CD3D2C5DC2CCAFD2C0D0AD6C7C4DCD7AAC9ED2CD7F326D3D2CAB12C313833302C323036342CD7F3C5DC2C0D0AD6BBD6B4D0D0B2CECAFD2CD7F3C5DCCAB12C313737302C323036342CD3D2C5DC2CCAB9D3C3BCBCC4DC2C393837393939390D0AD6BBD6B4D0D0B2CECAFD2CD7F3C5DCCAB12C313636382C323036342CD3D2C5DC2CCAB9D3C3BCBCC4DC2C393837393939390D0AD6BBD6B4D0D0B2CECAFD2CD7F3C5DCCAB12C313636302C323036342CD3D2C5DC2CCAB9D3C3BCBCC4DC2C393837393939390D0AD3D2CCF828D6FAC5DC292CD3D2C5DCCAB12C323238302C313737352CD7F3C5DC2C0D0AD7F3CCF82CD7F3C5DCCAB12C323830302C323836332CD7F3C5DC2C0D0AD6C7C4DCD7AAC9ED2CD7F326D3D2CAB12C323533392C323036332CD7F3C5DC0D0AD6C7C4DCD7AAC9ED2CD7F326D3D2CAB12C313331342C323036342CD3D2C5DC",
       -- 副本7
       "BDF8CDBCB4ABCBCDC3C52CD7F326D3D22C333034352C313531392CB2BBB1E42C0D0ABDF8CDBCB4ABCBCDC3C52CD7F326D3D22C333036352C313531392CB2BBB1E42C0D0ABDF8CDBCB4ABCBCDC3C52CD7F326D3D22C333038352C313531392CB2BBB1E42C",
       -- 副本8
       "BDF8CDBCB4ABCBCDC3C52CD7F326D3D22C333034352C313531392CB2BBB1E42C0D0ABDF8CDBCB4ABCBCDC3C52CD7F326D3D22C333036352C313531392CB2BBB1E42C0D0ABDF8CDBCB4ABCBCDC3C52CD7F326D3D22C333038352C313531392CB2BBB1E42C",
       -- 副本9
       "BDF8CDBCB4ABCBCDC3C52CD7F326D3D22C333034352C313531392CB2BBB1E42C0D0ABDF8CDBCB4ABCBCDC3C52CD7F326D3D22C333036352C313531392CB2BBB1E42C0D0ABDF8CDBCB4ABCBCDC3C52CD7F326D3D22C333038352C313531392CB2BBB1E42C",
	   -- 副本10
	   "",
	   -- 副本11
	   "",
	   -- 副本12
	   "",
	   -- 副本13
	   "",
	   -- 副本14
	   "",
	   -- 副本15
	   "",
	   -- 副本16
	   "",
	   -- 副本17
	   "",
    },
    -- 任务列表
    -- 任务会在跳转到对应地图时执行，因此如mapId中未配置或者初始飞机不在任务地点则无法领取任务
    -- 不同npc或不同地图的任务请配置多个task
   
    onScriptRound = function () -- 副本每次切换地图回调
    if (getmapid() == 9300) then
        ini_change("tobot_hit_range_down",20)
		ini_change("tobot_hit_range_top",400)
		ini_change("tobot_hit_range_max",300)
    end
	if (getmapid() == 9300) then
        ini_change("tobot_hit_range_down",20)
		ini_change("tobot_hit_range_top",150)
		ini_change("tobot_hit_range_max",300)
    end
	if (getmapid() == 9302) then
		labellasttime=gettime(3)
		labelnowtime=0
		repeat
			sleep(100)
			if mob_if("机关-开启传送门")==1 then
			speak("机关-开启传送门")
			ini_change("tobot_hit_range_max",1500)
			ini_change("tobot_hit_range_ignore",2000)
			end
			if mob_if("机关-开启传送门")==0 then
			ini_change("tobot_hit_range_max",250)
			ini_change("tobot_hit_range_ignore",2000)
			end
			labelnowtime=gettime(3)
			if labelnowtime - labellasttime ==10 or labelnowtime - labellasttime ==-50 then
				speak("超时10分钟，10s退出副本")
				sleep(10000)
				plane(70)
			end
		until(door_if(3000,1519)==1 or getmapid() ~= 9302)
	end
	if (getmapid() == 9303) then
		labellasttime=gettime(3)
		labelnowtime=0
		repeat
			sleep(100)
			if mob_if("机关-开启传送门")==1 then
			speak("机关-开启传送门")
			ini_change("tobot_hit_range_max",1500)
			ini_change("tobot_hit_range_ignore",2000)
			end
			if mob_if("机关-开启传送门")==0 then
			ini_change("tobot_hit_range_max",250)
			ini_change("tobot_hit_range_ignore",2000)
			end
			labelnowtime=gettime(3)
			if labelnowtime - labellasttime ==10 or labelnowtime - labellasttime ==-50 then
				speak("超时10分钟，10s退出副本")
				sleep(10000)
				plane(70)
			end
		until(door_if(2970,1519)==1 or getmapid() ~= 9303)
	end
	if (getmapid() == 9304) then
	   ini_change("tobot_hit_range_max",2000)
	   ini_change("tobot_hit_range_ignore",2000)
	end
	if (getmapid() == 9305) then
	   ini_change("tobot_hit_range_max",250)
	   ini_change("find_showname",1)
	   ini_change("find_showhp",1)
	   bot_stop()
	   ini_change("tobot_scriptbot",0)
	   sleep(500)
	   common.wearGongji()
	   sleep(500)
	   ini_change("tobot_scriptbot",1)
	   bot_start()
	   repeat
			sleep(200)
			if isbuff('玛烈赤斯之眼')==0 then --紫金
				useskill(43501018,1) --猴子
				sleep(100)
				if isbuff('一花一世界，一叶一菩提')==0 then  --无敌
					useskill(5000420,1)	--灵宠
					sleep(100)
					if isbuff('灵宠技能效果')==0 then --魔免
						useskill(43501022,1)  --朵朵
						sleep(100)
						if isbuff('每天都要美美哒')==0 then --魔免
							useskill(43501025,1) --红毛
							sleep(100)
							if isbuff('破坏王技能')==0 then
								--item_use(611113089)  --最大攻击免疫
								sleep(100)
								if isbuff('免疫效果')==0 then --免疫
									--item_use(611113088)  --最大属性免疫
									sleep(100)
									if isbuff('免疫效果')==0 then --免疫
										useskill(999005,1) --摄魂
										sleep(100)
										if isbuff('宠物效果')==0 then--混乱
											useskill(999006,1) --爱河
											sleep(100)
											if isbuff('宠物效果')==0 then--眩晕
												useskill(999003,1) --爱河
												sleep(100)
											end
										end
										if isbuff('食品效果')==0 then --三星芝士汤
											--item_use(611113016)
											sleep(100)
										end
										if isbuff('吸收效果')==0 then
											--item_use(611113086)--最大吸红
											sleep(100)
										end
										if isbuff('古代之力')==0 then
											--item_use(430453126)--星球坚不可摧
											sleep(100)
										end
									end
								end
							end
						end
					end
				end
			end
		until(door_if(3065,2863)==1)
	end
	if (getmapid() == 9306) then
		ini_change("ban_hit_mob",1)
		ini_change("find_showname",0)
		ini_change("find_showhp",0)
		bot_stop()
	    ini_change("tobot_scriptbot",0)
	    sleep(500)
		bot_stop()
	    common.wearDiaoluo()
	    sleep(500)
		ini_change("ban_hit_mob",0)
	    ini_change("tobot_scriptbot",1)
	    bot_start()
		labellasttime=gettime(3)
		labelnowtime=0
		repeat 
			sleep(100)
			if door_if(3065,1519) == 1 then 
				bot_stop()--停止挂机--
				sleep(2000)
				plane(94801)
			end
			labelnowtime=gettime(3)
			if labelnowtime - labellasttime ==10 or labelnowtime - labellasttime ==-50 then
				speak("超时10分钟，10s退出副本")
				sleep(10000)
				plane(70)
			end
		until (getmapid() ~= 9306)
    end
	if (getmapid() == 9307) then
		ini_change("ban_hit_mob",1)
		ini_change("find_showname",0)
		ini_change("find_showhp",0)
		bot_stop()
	    ini_change("tobot_scriptbot",0)
	    sleep(500)
		bot_stop()
	    common.wearDiaoluo()
	    sleep(500)
		ini_change("ban_hit_mob",0)
	    ini_change("tobot_scriptbot",1)
	    bot_start()
		labellasttime=gettime(3)
		labelnowtime=0
		repeat 
			sleep(100)
			if door_if(3065,1519) == 1 then 
				bot_stop()--停止挂机--
				sleep(2000)
				plane(94801)
			end
			labelnowtime=gettime(3)
			if labelnowtime - labellasttime ==10 or labelnowtime - labellasttime ==-50 then
				speak("超时10分钟，10s退出副本")
				sleep(10000)
				plane(70)
			end
		until (getmapid() ~= 9307 )
    end
	if (getmapid() == 9308) then
		ini_change("ban_hit_mob",1)
		ini_change("find_showname",0)
		ini_change("find_showhp",0)
		bot_stop()
	    ini_change("tobot_scriptbot",0)
	    sleep(500)
		bot_stop()
	    common.wearDiaoluo()
	    sleep(500)
		ini_change("ban_hit_mob",0)
	    ini_change("tobot_scriptbot",1)
	    bot_start()
		labellasttime=gettime(3)
		labelnowtime=0
		repeat 
			sleep(100)
			if door_if(3065,1519) == 1 then 
				bot_stop()--停止挂机--
				sleep(2000)
				plane(94801)
			end
			labelnowtime=gettime(3)
			if labelnowtime - labellasttime ==10 or labelnowtime - labellasttime ==-50 then
				speak("超时10分钟，10s退出副本")
				sleep(10000)
				plane(70)
			end
		until (getmapid() ~= 9308 )
    end
    end
})